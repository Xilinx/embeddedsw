/******************************************************************************
* Copyright (c) 2024 Advanced Micro Devices, Inc. All Rights Reserved.
* SPDX-License-Identifier: MIT
 ******************************************************************************/

 /*****************************************************************************/
 /**
 *
 * @file xilpuf_spartan_ultrascale_plus_example.h.
 * This file contains macros which needs to configured by user for
 * xilpuf_example.cand based on the options selected by user operations will be
 * performed.
 *
 * This example is supported for spartan ultrascale plus devices.
 *
 * <pre>
 * MODIFICATION HISTORY:
 *
 * Ver   Who     Date     Changes
 * ----- ------  -------- ------------------------------------------------------
 * 1.0   kpt     08/23/24 First release
 *
 * </pre>
 *
 * User configurable parameters for PUF
 *------------------------------------------------------------------------------
 * #define XPUF_RED_KEY
 * 	      "0000000000000000000000000000000000000000000000000000000000000000"
 * Red Key to be encrypted by PUF KEY should be provided in string format.It
 * should be either 32 or 64 characters long as only 128 bit and 256 bit key
 * are supported.
 *
 * #define XPUF_RED_KEY_LEN				(XPUF_RED_KEY_SIZE_256)
 *							(or)
 *						(XPUF_RED_KEY_SIZE_128)
 * XPUF_RED_KEY_LEN can be configured as one of the two provided options. This
 * configuration should be done on the basis of the length of the red key in bits.
 * Only 128 bit and 256 bit key are supported. By default the length of red key is
 * configured as 256 bit.
 *
 * #define XPUF_IV				"000000000000000000000000"
 * IV should be provided in string format.It should be 24 characters long, valid
 * characters are 0-9,a-f,A-F. Any other character is considered as invalid
 * string.The value mentioned here will be converted to hex buffer.It is used
 * with the AES-GCM cryptographic hardware in order to encrypt red key.
 *
 * #define XPUF_GENERATE_KEK_N_ID			(TRUE)
 * This macro must be configured as TRUE to generate both PUF KEK and PUF ID. In order
 * to generate PUF ID only, it should be configured as FALSE. The default option is set
 * as TRUE to enable encryption of Red Key.
 *
 * #define XPUF_KEY_GENERATE_OPTION		(XPUF_REGISTRATION)
 *							(or)
 *						(XPUF_REGEN_ON_DEMAND)
 * PUF Key can be generated by PUF registration or PUF on-demand
 * regeneration.The user can configure XPUF_KEY_GENERATE_OPTION as either
 * XPUF_REGISTRATION or XPUF_REGEN_ON_DEMAND to select the mode of PUF operation
 * to generate helper data. It should be configured only when XPUF_GENERATE_KEK_N_ID as TRUE.
 *
 *
  #define XPUF_CHASH				(0x00000000)
 * CHASH value should be supplied if XPUF_READ_HD_OPTION is configured as
 * XPUF_READ_FROM_RAM.The length of CHASH should be 24 bits This can be obtained
 * by performing PUF registration and writing the helper data on the UART.
 *
 * #define XPUF_AUX				(0x00000000)
 * AUX value should be supplied if XPUF_READ_HD_OPTION is configured as
 * XPUF_READ_FROM_RAM.The length of AUX should be 32 bits This can be obtained
 * by performing PUF registration and writing the helper data on the UART.
 *
 * #define XPUF_SYN_DATA_ADDRESS		(0x00000000)
 * Address of syndrome data should be supplied if XPUF_READ_HD_OPTION is
 * configured as XPUF_READ_FROM_RAM.
 *
 * #define XPUF_WRITE_PUF_HASH_IN_EFUSE		(FALSE)
 * If this option is configured as TRUE then hash of PUF helper data is written into the
 * eFuse.
 *

 * #define XPUF_READ_SEC_CTRL_BITS		(FALSE)
 * This option should be configured as TRUE to read secure control eFUSE bits
 * of PUF
 *
 * #define XPUF__SEC_CTRL_BITS		(FALSE)
 * This option should be configured as TRUE to program secure control eFUSE bits
 * of PUF
 *
 *
 * #define XPUF_GLBL_VAR_FLTR_OPTION	(TRUE)
 * It is recommended to always enable this option to ensure entropy. It can
 * be configured as FALSE to disable Global Variation Filter.
 *
 ******************************************************************************/
#ifndef XILPUF_EXAMPLE_H
#define XILPUF_EXAMPLE_H

#ifdef __cplusplus
extern "C" {
#endif

/***************************** Include Files *********************************/
#include "xil_types.h"

/************************** Constant Definitions *****************************/
/* For reading Secure control eFUSE bits of PUF */
#define XPUF_READ_HASH_PUF_OR_KEY			(FALSE)

#define XPUF_RED_KEY	\
	"0000000000000000000000000000000000000000000000000000000000000000"

/*
 * Below macro values should match with enum XSecure_AesKeySize.
 * As preprocessor can't handle enums at preprocessing stage of compilation,
 * these macros are defined.
 */
#define XPUF_RED_KEY_SIZE_128		(0U)
#define XPUF_RED_KEY_SIZE_256		(2U)

#define XPUF_RED_KEY_LEN			(XPUF_RED_KEY_SIZE_256)

#define XPUF_REGISTRATION 0U
#define XPUF_REGEN_ON_DEMAND 1U

#define XPUF_RED_KEY_LEN_IN_BYTES 		(32U)

#define XPUF_IV					"000000000000000000000000"

#define XPUF_GENERATE_KEK_N_ID			(TRUE)
#define XPUF_KEY_GENERATE_OPTION		(XPUF_REGISTRATION)
#define XPUF_GLBL_VAR_FLTR_OPTION	(TRUE)

#if (XPUF_KEY_GENERATE_OPTION == XPUF_REGEN_ON_DEMAND)
#define XPUF_CHASH				(0x00000000U)
#define XPUF_AUX				(0x00000000U)
#define XPUF_SYN_DATA_ADDRESS			(0x00000000U)
#elif (XPUF_KEY_GENERATE_OPTION == XPUF_REGISTRATION)
#define XPUF_WRITE_PUF_HASH_IN_EFUSE 			(FALSE)
#endif

#define XPUF_WRITE_BLACK_KEY_OPTION		(FALSE)

/* For programming Secure control eFUSE bits of PUF */
#define XPUF_PRGM_HASH_PUF_OR_KEY				(FALSE)

#define PUF_RO_SWAP				(0x00000000U)

/**************************** Type Definitions *******************************/

/***************** Macros (Inline Functions) Definitions *********************/

#ifdef __cplusplus
}
#endif

#endif /* XILPUF_SPARTAN_ULTRASCALE_PLUS_EXAMPLE_H_ */
