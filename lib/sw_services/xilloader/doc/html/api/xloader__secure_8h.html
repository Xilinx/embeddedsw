<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>xilloader: xloader_secure.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="HTML_custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xlogo_bg.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">xilloader
   </div>
   <div id="projectbrief">Vitis Drivers API Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Overview</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="globals.html"><span>APIs</span></a></li>
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('xloader__secure_8h.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">xloader_secure.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Overview</h2>
<div class="textblock"><p>This file contains all security related data. </p>
<pre>
MODIFICATION HISTORY:</pre><pre>Ver   Who  Date     Changes
----- ---- -------- -------------------------------------------------------
1.00  vns  04/23/19 First release
1.01  vns  07/09/19 Added PPK and SPK integrity checks
                    Updated chunk size for secure partition
                    Added encryption + authentication support
      vns  07/23/19 Added functions to load secure headers
      vns  08/23/19 Added buffer cleaning on failure
                    Added different key sources support
1.02  vns  02/23/20 Added DPA CM enable/disable functionality
      har  02/28/20 Added minor error codes for security
      vns  03/01/20 Added PUF KEK decrypt support
      ana  04/02/20 Added crypto engine KAT test function calls
      bsv  04/07/20 Change CSUDMA name to PMCDMA
      vns  04/13/20 Moved Aes instance to Secure structure
1.03  ana  06/04/20 Removed XLOADER_ECDSA_INDEXVAL macro and
                    updated u32 datatype to u8 datatype
      tar  07/23/20 Fixed MISRA-C required violations
      kpt  07/30/20 Added minor error codes for ENC only and macros
                    related to IV
      bsv  08/06/20 Added delay load support for secure cases
      har  08/11/20 Added XLoader_AuthJtagMessage structure  and macros for
                    Authenticated JTAG
      td   08/19/20 Fixed MISRA C violations Rule 10.3
      bsv  08/21/20 Included xil_util.h for XSECURE_TEMPORAL_CHECK macro
      har  08/24/20 Added macros related to ECDSA P521 support
      kal  09/14/20 Added new error code to XLoader_SecErrCodes
      har  09/30/20 Deprecated Family Key support
      bsv  10/19/20 Parallel DMA changes
      kpt  10/19/2020 Code clean up
      har  10/19/20 Replaced ECDSA in header files
1.04  har  11/27/20 Added macros related to PDI DpaCm configuration
      bm   12/16/20 Added PLM_SECURE_EXCLUDE macro. Also moved authentication and
                    encryption related code to <a class="el" href="xloader__auth__enc_8h.html" title="This file contains all common security related data. ">xloader_auth_enc.h</a> file
1.05  har  03/17/21 Added API to set the secure state of device
      har  05/20/21 Updated copyright year
1.06  har  07/15/21 Fixed doxygen warnings
      kpt  09/09/21 Fixed SW-BP-BLIND-WRITE in XLoader_SecureClear
1.07  kpt  10/07/21 Removed function prototype XLoader_ProcessSecurePrtn
      kpt  10/20/21 Declared temporal variables in XLoader_SecureTempParams
      kpt  10/28/21 Added flags in XLoader_SecureInit function prototype
      bsv  02/09/22 Code clean up
      bsv  02/11/22 Code optimization to reduce text size
      kpt  02/18/22 Removed Flags param from XLoader_SecureInit function prototype
1.08  dc   07/12/22 Moved error codes related to buffer clear to xplmi_status.h</pre><pre></pre><dl class="section note"><dt>Note</dt><dd></dd></dl>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a9c37bf573525769b2821bf9c45858c08"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="xloader__secure_8h.html#a9c37bf573525769b2821bf9c45858c08">XLOADER_EFUSE_PPK0_START_OFFSET</a>&#160;&#160;&#160;(0xF1250100U)</td></tr>
<tr class="memdesc:a9c37bf573525769b2821bf9c45858c08"><td class="mdescLeft">&#160;</td><td class="mdescRight">PPK0 Start register address.  <a href="#a9c37bf573525769b2821bf9c45858c08">More...</a><br/></td></tr>
<tr class="separator:a9c37bf573525769b2821bf9c45858c08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0281b00807125a658c2dde0ccc8f7925"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="xloader__secure_8h.html#a0281b00807125a658c2dde0ccc8f7925">XLOADER_EFUSE_PPK1_START_OFFSET</a>&#160;&#160;&#160;(0xF1250120U)</td></tr>
<tr class="memdesc:a0281b00807125a658c2dde0ccc8f7925"><td class="mdescLeft">&#160;</td><td class="mdescRight">PPK1 Start register address.  <a href="#a0281b00807125a658c2dde0ccc8f7925">More...</a><br/></td></tr>
<tr class="separator:a0281b00807125a658c2dde0ccc8f7925"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54f0e6680ef984f607e3c90dbc869f0e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="xloader__secure_8h.html#a54f0e6680ef984f607e3c90dbc869f0e">XLOADER_EFUSE_PPK2_START_OFFSET</a>&#160;&#160;&#160;(0xF1250140U)</td></tr>
<tr class="memdesc:a54f0e6680ef984f607e3c90dbc869f0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">PPK2 Start register address.  <a href="#a54f0e6680ef984f607e3c90dbc869f0e">More...</a><br/></td></tr>
<tr class="separator:a54f0e6680ef984f607e3c90dbc869f0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37961c447b4a134f280d82ef4e8b542e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="xloader__secure_8h.html#a37961c447b4a134f280d82ef4e8b542e">XLOADER_EFUSE_PPK2_END_OFFSET</a>&#160;&#160;&#160;(0xF125015CU)</td></tr>
<tr class="memdesc:a37961c447b4a134f280d82ef4e8b542e"><td class="mdescLeft">&#160;</td><td class="mdescRight">PPK2 End register address.  <a href="#a37961c447b4a134f280d82ef4e8b542e">More...</a><br/></td></tr>
<tr class="separator:a37961c447b4a134f280d82ef4e8b542e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97c1c4a75d3823f9ecaa3d6eb2294e9c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="xloader__secure_8h.html#a97c1c4a75d3823f9ecaa3d6eb2294e9c">XLOADER_EFUSE_SEC_MISC0_OFFSET</a>&#160;&#160;&#160;(0xF12500E4U)</td></tr>
<tr class="memdesc:a97c1c4a75d3823f9ecaa3d6eb2294e9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Security Misc0 register address.  <a href="#a97c1c4a75d3823f9ecaa3d6eb2294e9c">More...</a><br/></td></tr>
<tr class="separator:a97c1c4a75d3823f9ecaa3d6eb2294e9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a483a3cd071fb861c4ce0ab0174c8b829"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="xloader__secure_8h.html#a483a3cd071fb861c4ce0ab0174c8b829">XLOADER_EFUSE_SEC_DEC_MASK</a>&#160;&#160;&#160;(0x0000FFFFU)</td></tr>
<tr class="memdesc:a483a3cd071fb861c4ce0ab0174c8b829"><td class="mdescLeft">&#160;</td><td class="mdescRight">DEC_ONLY fuse mask in Security Misc0 register.  <a href="#a483a3cd071fb861c4ce0ab0174c8b829">More...</a><br/></td></tr>
<tr class="separator:a483a3cd071fb861c4ce0ab0174c8b829"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa233d1265392f76e260ac09c0d16c8f8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="xloader__secure_8h.html#aa233d1265392f76e260ac09c0d16c8f8">XLOADER_EFUSE_MISC_CTRL_OFFSET</a>&#160;&#160;&#160;(0xF12500A0U)</td></tr>
<tr class="memdesc:aa233d1265392f76e260ac09c0d16c8f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Misc CTRL register.  <a href="#aa233d1265392f76e260ac09c0d16c8f8">More...</a><br/></td></tr>
<tr class="separator:aa233d1265392f76e260ac09c0d16c8f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9410756c2dbe4b6bd6cdfce81a5bd7fa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="xloader__secure_8h.html#a9410756c2dbe4b6bd6cdfce81a5bd7fa">XLoader_SecureInit</a> (XLoader_SecureParams *SecurePtr, XilPdi *PdiPtr, u32 PrtnNum)</td></tr>
<tr class="memdesc:a9410756c2dbe4b6bd6cdfce81a5bd7fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function initializes XLoader_SecureParams's instance.  <a href="#a9410756c2dbe4b6bd6cdfce81a5bd7fa">More...</a><br/></td></tr>
<tr class="separator:a9410756c2dbe4b6bd6cdfce81a5bd7fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04bdca8398a9278a9c382ef66ad42ed9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="xloader__secure_8h.html#a04bdca8398a9278a9c382ef66ad42ed9">XLoader_SecureCopy</a> (XLoader_SecureParams *SecurePtr, u64 DestAddr, u32 Size)</td></tr>
<tr class="memdesc:a04bdca8398a9278a9c382ef66ad42ed9"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function loads secure non-cdo partitions.  <a href="#a04bdca8398a9278a9c382ef66ad42ed9">More...</a><br/></td></tr>
<tr class="separator:a04bdca8398a9278a9c382ef66ad42ed9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9171035e129091fbaddbc27756381f76"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="xloader__secure_8h.html#a9171035e129091fbaddbc27756381f76">XLoader_SecureClear</a> (void)</td></tr>
<tr class="memdesc:a9171035e129091fbaddbc27756381f76"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is called to clear secure critical data in case of exceptions.  <a href="#a9171035e129091fbaddbc27756381f76">More...</a><br/></td></tr>
<tr class="separator:a9171035e129091fbaddbc27756381f76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5054d79a7dcc052ae83d997f183c8779"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="xloader__secure_8h.html#a5054d79a7dcc052ae83d997f183c8779">XLoader_SecureChunkCopy</a> (XLoader_SecureParams *SecurePtr, u64 SrcAddr, u8 Last, u32 BlockSize, u32 TotalSize)</td></tr>
<tr class="memdesc:a5054d79a7dcc052ae83d997f183c8779"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function copies the data from SrcAddr to chunk memory during processing of secure partitions.  <a href="#a5054d79a7dcc052ae83d997f183c8779">More...</a><br/></td></tr>
<tr class="separator:a5054d79a7dcc052ae83d997f183c8779"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e5d053bbf2e5283aac4b2a1e860b44d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="xloader__secure_8h.html#a4e5d053bbf2e5283aac4b2a1e860b44d">XLoader_CheckNonZeroPpk</a> (void)</td></tr>
<tr class="memdesc:a4e5d053bbf2e5283aac4b2a1e860b44d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function checks if PPK is programmed.  <a href="#a4e5d053bbf2e5283aac4b2a1e860b44d">More...</a><br/></td></tr>
<tr class="separator:a4e5d053bbf2e5283aac4b2a1e860b44d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e99458db1239a8f1bcb70eee9025232"><td class="memItemLeft" align="right" valign="top">u32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="xloader__secure_8h.html#a3e99458db1239a8f1bcb70eee9025232">XLoader_GetAHWRoT</a> (const u32 *AHWRoTPtr)</td></tr>
<tr class="memdesc:a3e99458db1239a8f1bcb70eee9025232"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the state of authenticated boot.  <a href="#a3e99458db1239a8f1bcb70eee9025232">More...</a><br/></td></tr>
<tr class="separator:a3e99458db1239a8f1bcb70eee9025232"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27d4a7f2cecd7b051a5418ad7586cac3"><td class="memItemLeft" align="right" valign="top">u32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="xloader__secure_8h.html#a27d4a7f2cecd7b051a5418ad7586cac3">XLoader_GetSHWRoT</a> (const u32 *SHWRoTPtr)</td></tr>
<tr class="memdesc:a27d4a7f2cecd7b051a5418ad7586cac3"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the state of encrypted boot.  <a href="#a27d4a7f2cecd7b051a5418ad7586cac3">More...</a><br/></td></tr>
<tr class="separator:a27d4a7f2cecd7b051a5418ad7586cac3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade5fc1ce6a279c921672d5692df5cf56"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="xloader__secure_8h.html#ade5fc1ce6a279c921672d5692df5cf56">XLoader_SetSecureState</a> (void)</td></tr>
<tr class="memdesc:ade5fc1ce6a279c921672d5692df5cf56"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function reads the value of PPK efuse bits, DEC only efuse bits and fields in bootheader and accordingly sets the Secure State of boot.  <a href="#ade5fc1ce6a279c921672d5692df5cf56">More...</a><br/></td></tr>
<tr class="separator:ade5fc1ce6a279c921672d5692df5cf56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31df7acaead3af0dfa1735979d3cee12"><td class="memItemLeft" align="right" valign="top">XLoader_SecureTempParams *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="xloader__secure_8h.html#a31df7acaead3af0dfa1735979d3cee12">XLoader_GetTempParams</a> (void)</td></tr>
<tr class="memdesc:a31df7acaead3af0dfa1735979d3cee12"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the pointer to XLoader_SecureTempParams.  <a href="#a31df7acaead3af0dfa1735979d3cee12">More...</a><br/></td></tr>
<tr class="separator:a31df7acaead3af0dfa1735979d3cee12"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="aa233d1265392f76e260ac09c0d16c8f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define XLOADER_EFUSE_MISC_CTRL_OFFSET&#160;&#160;&#160;(0xF12500A0U)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Misc CTRL register. </p>

<p>Referenced by <a class="el" href="xloader__auth__enc_8h.html#a6be961c2f80c31d661adab83f62ba790">XLoader_IsPpkValid()</a>.</p>

</div>
</div>
<a class="anchor" id="a9c37bf573525769b2821bf9c45858c08"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define XLOADER_EFUSE_PPK0_START_OFFSET&#160;&#160;&#160;(0xF1250100U)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PPK0 Start register address. </p>

<p>Referenced by <a class="el" href="xloader__secure_8h.html#a4e5d053bbf2e5283aac4b2a1e860b44d">XLoader_CheckNonZeroPpk()</a>, and <a class="el" href="xloader__auth__enc_8h.html#a6be961c2f80c31d661adab83f62ba790">XLoader_IsPpkValid()</a>.</p>

</div>
</div>
<a class="anchor" id="a0281b00807125a658c2dde0ccc8f7925"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define XLOADER_EFUSE_PPK1_START_OFFSET&#160;&#160;&#160;(0xF1250120U)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PPK1 Start register address. </p>

<p>Referenced by <a class="el" href="xloader__auth__enc_8h.html#a6be961c2f80c31d661adab83f62ba790">XLoader_IsPpkValid()</a>.</p>

</div>
</div>
<a class="anchor" id="a37961c447b4a134f280d82ef4e8b542e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define XLOADER_EFUSE_PPK2_END_OFFSET&#160;&#160;&#160;(0xF125015CU)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PPK2 End register address. </p>

<p>Referenced by <a class="el" href="xloader__secure_8h.html#a4e5d053bbf2e5283aac4b2a1e860b44d">XLoader_CheckNonZeroPpk()</a>.</p>

</div>
</div>
<a class="anchor" id="a54f0e6680ef984f607e3c90dbc869f0e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define XLOADER_EFUSE_PPK2_START_OFFSET&#160;&#160;&#160;(0xF1250140U)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PPK2 Start register address. </p>

<p>Referenced by <a class="el" href="xloader__auth__enc_8h.html#a6be961c2f80c31d661adab83f62ba790">XLoader_IsPpkValid()</a>.</p>

</div>
</div>
<a class="anchor" id="a483a3cd071fb861c4ce0ab0174c8b829"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define XLOADER_EFUSE_SEC_DEC_MASK&#160;&#160;&#160;(0x0000FFFFU)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>DEC_ONLY fuse mask in Security Misc0 register. </p>

<p>Referenced by <a class="el" href="xloader__secure_8h.html#ade5fc1ce6a279c921672d5692df5cf56">XLoader_SetSecureState()</a>.</p>

</div>
</div>
<a class="anchor" id="a97c1c4a75d3823f9ecaa3d6eb2294e9c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define XLOADER_EFUSE_SEC_MISC0_OFFSET&#160;&#160;&#160;(0xF12500E4U)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Security Misc0 register address. </p>

<p>Referenced by <a class="el" href="xloader__secure_8h.html#ade5fc1ce6a279c921672d5692df5cf56">XLoader_SetSecureState()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a4e5d053bbf2e5283aac4b2a1e860b44d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int XLoader_CheckNonZeroPpk </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function checks if PPK is programmed. </p>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>XST_SUCCESS on success.</li>
<li>XLOADER_ERR_GLITCH_DETECTED if glitch is detected.</li>
<li>XST_FAILURE on failure. </li>
</ul>
</dd></dl>
<ul>
<li>Check if any of the PPK efuses are not programmed. </li>
</ul>

<p>References <a class="el" href="xloader__secure_8h.html#a9c37bf573525769b2821bf9c45858c08">XLOADER_EFUSE_PPK0_START_OFFSET</a>, and <a class="el" href="xloader__secure_8h.html#a37961c447b4a134f280d82ef4e8b542e">XLOADER_EFUSE_PPK2_END_OFFSET</a>.</p>

<p>Referenced by <a class="el" href="xloader__plat__secure_8c.html#ab971c3f4e75170b57d1f5fdcd51cc092">XLoader_CheckSecureStateAuth()</a>.</p>

</div>
</div>
<a class="anchor" id="a3e99458db1239a8f1bcb70eee9025232"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u32 XLoader_GetAHWRoT </td>
          <td>(</td>
          <td class="paramtype">const u32 *&#160;</td>
          <td class="paramname"><em>AHWRoTPtr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function returns the state of authenticated boot. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">AHWRoTPtr</td><td>- Always NULL except at time of initialization of SecureStateAHWRoT variable</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>XPLMI_RTCFG_SECURESTATE_AHWROT - PPK fuses are programmed</li>
<li>XPLMI_RTCFG_SECURESTATE_EMUL_AHWROT - BHDR auth is enabled</li>
<li>XPLMI_RTCFG_SECURESTATE_NONSECURE - Neither PPK fuses are programmed nor BH auth is enabled </li>
</ul>
</dd></dl>
<ul>
<li>If AHWRoTPtr is not NULL, then set the SecureStateSHWRoT. Otherwise return the previous stored Secure state.</li>
</ul>

<p>Referenced by <a class="el" href="xloader__auth__enc_8h.html#a434f49bc94a9078a86451ac5bde637cc">XLoader_AddAuthJtagToScheduler()</a>, <a class="el" href="net_2xloader__plat__secure_8h.html#a331850d019d28f888cfa3499be80529d">XLoader_AddDeviceStateChangeToScheduler()</a>, <a class="el" href="xloader__auth__enc_8h.html#a9df696fd17dec50576f817a1cd1f7105">XLoader_SecureEncInit()</a>, <a class="el" href="xloader__auth__enc_8h.html#a7d852b900fa863fa8719bba0e2699423">XLoader_SecureValidations()</a>, and <a class="el" href="xloader__secure_8h.html#ade5fc1ce6a279c921672d5692df5cf56">XLoader_SetSecureState()</a>.</p>

</div>
</div>
<a class="anchor" id="a27d4a7f2cecd7b051a5418ad7586cac3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u32 XLoader_GetSHWRoT </td>
          <td>(</td>
          <td class="paramtype">const u32 *&#160;</td>
          <td class="paramname"><em>SHWRoTPtr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function returns the state of encrypted boot. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">SHWRoTPtr</td><td>- Always NULL except at time of initialization of SecureStateSHWRoT variable</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>XPLMI_RTCFG_SECURESTATE_SHWROT - Any DEC only fuse is programmed</li>
<li>XPLMI_RTCFG_SECURESTATE_EMUL_SHWROT - PLM is encrypted</li>
<li>XPLMI_RTCFG_SECURESTATE_NONSECURE - Neither DEC only fuses are programmed nor PLM is encrypted </li>
</ul>
</dd></dl>
<ul>
<li>If SHWRoTPtr is not NULL, then set the SecureStateSHWRoT. Otherwise return the previous stored Secure state.</li>
</ul>

<p>Referenced by <a class="el" href="net_2xloader__plat__secure_8h.html#a331850d019d28f888cfa3499be80529d">XLoader_AddDeviceStateChangeToScheduler()</a>, <a class="el" href="xloader__auth__enc_8h.html#a9df696fd17dec50576f817a1cd1f7105">XLoader_SecureEncInit()</a>, <a class="el" href="xloader__auth__enc_8h.html#a7d852b900fa863fa8719bba0e2699423">XLoader_SecureValidations()</a>, and <a class="el" href="xloader__secure_8h.html#ade5fc1ce6a279c921672d5692df5cf56">XLoader_SetSecureState()</a>.</p>

</div>
</div>
<a class="anchor" id="a31df7acaead3af0dfa1735979d3cee12"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">XLoader_SecureTempParams* XLoader_GetTempParams </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function returns the pointer to XLoader_SecureTempParams. </p>
<dl class="section return"><dt>Returns</dt><dd>Pointer to XLoader_SecureTempParams </dd></dl>

<p>Referenced by <a class="el" href="xloader__auth__enc_8h.html#aa912487046c04b1c90ca418a19ac3e0d">XLoader_ProcessAuthEncPrtn()</a>, <a class="el" href="xloader__prtn__load_8c.html#a629ebb0c55462b5cde87f7e91037b8c0">XLoader_PrtnCopy()</a>, <a class="el" href="xloader__auth__enc_8h.html#ac4b3b88f124856db12efa0ce4d6c81d0">XLoader_ReadAndVerifySecureHdrs()</a>, <a class="el" href="xloader__auth__enc_8h.html#a5aef75ed3205f50c75189b7c46099856">XLoader_SecureAuthInit()</a>, <a class="el" href="xloader__auth__enc_8h.html#a9df696fd17dec50576f817a1cd1f7105">XLoader_SecureEncInit()</a>, <a class="el" href="xloader__secure_8h.html#a9410756c2dbe4b6bd6cdfce81a5bd7fa">XLoader_SecureInit()</a>, and <a class="el" href="xloader__auth__enc_8h.html#a7d852b900fa863fa8719bba0e2699423">XLoader_SecureValidations()</a>.</p>

</div>
</div>
<a class="anchor" id="a5054d79a7dcc052ae83d997f183c8779"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int XLoader_SecureChunkCopy </td>
          <td>(</td>
          <td class="paramtype">XLoader_SecureParams *&#160;</td>
          <td class="paramname"><em>SecurePtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>SrcAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8&#160;</td>
          <td class="paramname"><em>Last</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>BlockSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>TotalSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function copies the data from SrcAddr to chunk memory during processing of secure partitions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">SecurePtr</td><td>is pointer to the XLoader_SecureParams instance </td></tr>
    <tr><td class="paramname">SrcAddr</td><td>is the source address from which the data is to be processed or copied </td></tr>
    <tr><td class="paramname">Last</td><td>notifies if the block to be processed is last or not </td></tr>
    <tr><td class="paramname">BlockSize</td><td>is size of the data block to be processed which doesn't include padding lengths and hash. </td></tr>
    <tr><td class="paramname">TotalSize</td><td>is pointer to TotalSize which has to be processed</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>XST_SUCCESS on success.</li>
<li>XLOADER_ERR_DATA_COPY_FAIL if failed to copy data to PMC RAM. </li>
</ul>
</dd></dl>
<ul>
<li>Copy the next chunk securely, and then wait for the process to be completed.</li>
<li>The following initialization is crucial as the authentication certificate and PUF data are now stored in the PMC RAM instead of the PPU1 RAM. During the processing of the first chunk of any partition, the second 32K chunk of the PMC RAM, starting from 0xf2008120, contains the authentication certificate and PUF data as applicable. As a result, the second chunk of the partition must be loaded at 0xf2000020, not at 0xf2008120. Therefore, double buffering is disabled when processing the first chunk, and only enabled from the second chunk onwards. The third chunk is loaded at 0xf2008120, and from then on, the chunks are loaded alternatively to the two 32KB chunks of the PMC RAM.</li>
</ul>

<p>Referenced by <a class="el" href="xloader__auth__enc_8h.html#aa912487046c04b1c90ca418a19ac3e0d">XLoader_ProcessAuthEncPrtn()</a>.</p>

</div>
</div>
<a class="anchor" id="a9171035e129091fbaddbc27756381f76"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int XLoader_SecureClear </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is called to clear secure critical data in case of exceptions. </p>
<p>The function also places AES, ECDSA_RSA and SHA3 in reset.</p>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>XST_SUCCESS on success.</li>
<li>XLOADER_ERR_SECURE_CLEAR_FAIL if failed to clear AES, RSA, SHA3 engines. </li>
</ul>
</dd></dl>
<p>Place SHA3 in reset </p>

<p>References <a class="el" href="xloader__auth__enc_8c.html#a22f293db863b881993077e17fc892007">XLoader_AuthEncClear()</a>, <a class="el" href="xloader__secure_8c.html#ae1ad484f4b4344573008a1fa138ad597">XLOADER_SHA3_RESET_REG</a>, and <a class="el" href="xloader__secure_8c.html#a18a802ef19167e4a011890ac7bf61f7d">XLOADER_SHA3_RESET_VAL</a>.</p>

</div>
</div>
<a class="anchor" id="a04bdca8398a9278a9c382ef66ad42ed9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int XLoader_SecureCopy </td>
          <td>(</td>
          <td class="paramtype">XLoader_SecureParams *&#160;</td>
          <td class="paramname"><em>SecurePtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>DestAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>Size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function loads secure non-cdo partitions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">SecurePtr</td><td>is pointer to the XLoader_SecureParams instance. </td></tr>
    <tr><td class="paramname">DestAddr</td><td>is load address of the partition. </td></tr>
    <tr><td class="paramname">Size</td><td>is unencrypted size of the partition in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>XST_SUCCESS on success and error code on failure </li>
</ul>
</dd></dl>
<ul>
<li>Update the length for last chunk</li>
<li>Process the partition.</li>
<li>Update variables for next chunk</li>
<li>On failure clear data at destination address </li>
</ul>

<p>References <a class="el" href="xloader__plat_8h.html#a3944db2060fd83c89b79580dd0caa0de">XLOADER_SECURE_CHUNK_SIZE</a>.</p>

<p>Referenced by <a class="el" href="xloader__prtn__load_8c.html#a629ebb0c55462b5cde87f7e91037b8c0">XLoader_PrtnCopy()</a>.</p>

</div>
</div>
<a class="anchor" id="a9410756c2dbe4b6bd6cdfce81a5bd7fa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int XLoader_SecureInit </td>
          <td>(</td>
          <td class="paramtype">XLoader_SecureParams *&#160;</td>
          <td class="paramname"><em>SecurePtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">XilPdi *&#160;</td>
          <td class="paramname"><em>PdiPtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>PrtnNum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function initializes XLoader_SecureParams's instance. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">SecurePtr</td><td>is pointer to the XLoader_SecureParams instance. </td></tr>
    <tr><td class="paramname">PdiPtr</td><td>is pointer to the XilPdi instance </td></tr>
    <tr><td class="paramname">PrtnNum</td><td>is the partition number to be processed</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>XST_SUCCESS on success.</li>
<li>XLOADER_ERR_MEMSET_SECURE_PTR if failed to set memory for secure pointer.</li>
<li>XLOADER_ERR_INIT_GET_DMA if failed to get DMA instance during initialization. </li>
</ul>
</dd></dl>
<ul>
<li>Initialize XLoader_SecureParms instance with zeros.</li>
<li>Initialize XLoader_SecureTempParams instance with zeros.</li>
<li>Read partition header from meta header.</li>
<li>The following initialization is crucial as the authentication certificate and PUF data are now stored in the PMC RAM instead of the PPU1 RAM. During the processing of the first chunk of any partition, the second 32K chunk of the PMC RAM, starting from 0xf2008120, contains the authentication certificate and PUF data as applicable. As a result, the second chunk of the partition must be loaded at 0xf2000020, not at 0xf2008120. Therefore, double buffering is disabled when processing the first chunk, and only enabled from the second chunk onwards. The third chunk is loaded at 0xf2008120, and from then on, the chunks are loaded alternatively to the two 32KB chunks of the PMC RAM.</li>
<li>Get DMA instance</li>
<li>Initialize the checksum.</li>
<li>Initialize the authentication.</li>
<li>Initialize the encryption. </li>
</ul>

<p>References <a class="el" href="xloader__secure_8c.html#a31df7acaead3af0dfa1735979d3cee12">XLoader_GetTempParams()</a>, <a class="el" href="xloader__auth__enc_8c.html#a5aef75ed3205f50c75189b7c46099856">XLoader_SecureAuthInit()</a>, and <a class="el" href="xloader__auth__enc_8c.html#a9df696fd17dec50576f817a1cd1f7105">XLoader_SecureEncInit()</a>.</p>

</div>
</div>
<a class="anchor" id="ade5fc1ce6a279c921672d5692df5cf56"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int XLoader_SetSecureState </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function reads the value of PPK efuse bits, DEC only efuse bits and fields in bootheader and accordingly sets the Secure State of boot. </p>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>XST_SUCCESS on SUCCESS and error code in case of failure.</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The Secure State of the device will be stored in two 32-bit registers in RTC area of PMCRAM and two global variables -one for authenticated boot and other for encrypted boot, for redundancy. </dd></dl>
<ul>
<li>Check secure state for authentication</li>
<li>Set the secure state for authentication in register and global variable.</li>
<li>Check secure state for encryption.</li>
<li>Read DEC_ONLY efuse bits.</li>
<li>If more than one DEC_ONLY efuse bits are programmed, then set the SHWRoT register.</li>
<li>If none of the DEC_ONLY efuse bits are programmed and PLM is encrypted, then set the SHWRoT register.</li>
<li>If none of the DEC_ONLY efuse bits are programmed and PLM is not encrypted, then set the SHWRoT register.</li>
</ul>

<p>References <a class="el" href="xloader__auth__enc_8h.html#ab971c3f4e75170b57d1f5fdcd51cc092">XLoader_CheckSecureStateAuth()</a>, <a class="el" href="xloader__secure_8h.html#a483a3cd071fb861c4ce0ab0174c8b829">XLOADER_EFUSE_SEC_DEC_MASK</a>, <a class="el" href="xloader__secure_8h.html#a97c1c4a75d3823f9ecaa3d6eb2294e9c">XLOADER_EFUSE_SEC_MISC0_OFFSET</a>, <a class="el" href="xloader__secure_8c.html#a3e99458db1239a8f1bcb70eee9025232">XLoader_GetAHWRoT()</a>, and <a class="el" href="xloader__secure_8c.html#a27d4a7f2cecd7b051a5418ad7586cac3">XLoader_GetSHWRoT()</a>.</p>

<p>Referenced by <a class="el" href="xloader_8c.html#acb10f2e97fecfb15aae4fed081b02502">XLoader_Init()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
	<p class="footer">&copy; Copyright 2015-2022 Xilinx, Inc. All Rights Reserved.</p>
	<p class="footer">&copy; Copyright 2022-2023 Advanced Micro Devices, Inc. All Rights Reserved.</p>
</div>
</body>
</html>
