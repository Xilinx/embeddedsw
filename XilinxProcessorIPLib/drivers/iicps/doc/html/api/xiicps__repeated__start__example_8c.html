<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>iicps: xiicps_repeated_start_example.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="HTML_custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xlogo_bg.gif"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">iicps
   </div>
   <div id="projectbrief">Vitis Drivers API Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Overview</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="globals.html"><span>APIs</span></a></li>
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="pages.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('xiicps__repeated__start__example_8c.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">xiicps_repeated_start_example.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Overview</h2>
<div class="textblock"><p>This is a repeated start example runs on zynqmp / versal evaluation boards using xiicps driver in polled mode. </p>
<p>The slave used is an EEPROM.</p>
<p>The example is tested with a 2Kb/8Kb serial IIC EEPROM (ST M24C02/M24C08). The WP pin of this EEPROM is hardwired to ground in the HW in which this was tested. This example can be used directly to read up to 16 pages from start address in this EEPROM (Since single address byte).</p>
<p>The AddressType should be u8 as the address pointer in the on-board EEPROM is 1 bytes.</p>
<p>This code assumes that no Operating System is being used.</p>
<dl class="section note"><dt>Note</dt><dd></dd></dl>
<p>The I2C controller does not indicate completion of a receive transfer if HOLD bit is set. Due to this errata, repeated start cannot be used if a receive transfer is followed by any other transfer on Zynq platform.</p>
<pre>
MODIFICATION HISTORY:</pre><pre>Ver   Who  Date     Changes
</p>
<hr/>
<p>
2.1   hk   03/15/10 First release
3.7   ask  04/17/18 Updated the Eeprom scanning mechanism
              as per the other examples (CR#997545)
3.11   rna  10/16/19 Added support for 64 page size eeproms on Veral based
              boards, scanning for eeprom on all I2C instances
      rna  03/26/20 Eeprom page size detection support is added.
</pre> </div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a03067e867debb67e8cc850dad9b4491b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="xiicps__repeated__start__example_8c.html#a03067e867debb67e8cc850dad9b4491b">IicPsRepeatedStartExample</a> (void)</td></tr>
<tr class="memdesc:a03067e867debb67e8cc850dad9b4491b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function writes, reads, and verifies the data to the IIC EEPROM.  <a href="#a03067e867debb67e8cc850dad9b4491b">More...</a><br/></td></tr>
<tr class="separator:a03067e867debb67e8cc850dad9b4491b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40d92867ead2dc8efe06207b8b0f3494"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="xiicps__repeated__start__example_8c.html#a40d92867ead2dc8efe06207b8b0f3494">EepromWriteData</a> (u16 ByteCount)</td></tr>
<tr class="memdesc:a40d92867ead2dc8efe06207b8b0f3494"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function writes a buffer of data to the IIC serial EEPROM.  <a href="#a40d92867ead2dc8efe06207b8b0f3494">More...</a><br/></td></tr>
<tr class="separator:a40d92867ead2dc8efe06207b8b0f3494"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f790bd9169574f1a1a9739b827cd04f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="xiicps__repeated__start__example_8c.html#a2f790bd9169574f1a1a9739b827cd04f">EepromReadDataRepStart</a> (u8 *BufferPtr, u16 ByteCount)</td></tr>
<tr class="memdesc:a2f790bd9169574f1a1a9739b827cd04f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function reads data from the IIC serial EEPROM into a specified buffer.  <a href="#a2f790bd9169574f1a1a9739b827cd04f">More...</a><br/></td></tr>
<tr class="separator:a2f790bd9169574f1a1a9739b827cd04f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a840291bc02cba5474a4cb46a9b9566fe"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="xiicps__repeated__start__example_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main</a> (void)</td></tr>
<tr class="memdesc:a840291bc02cba5474a4cb46a9b9566fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main function to call the Iic repeated start example.  <a href="#a840291bc02cba5474a4cb46a9b9566fe">More...</a><br/></td></tr>
<tr class="separator:a840291bc02cba5474a4cb46a9b9566fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a2f790bd9169574f1a1a9739b827cd04f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int EepromReadDataRepStart </td>
          <td>(</td>
          <td class="paramtype">u8 *&#160;</td>
          <td class="paramname"><em>BufferPtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u16&#160;</td>
          <td class="paramname"><em>ByteCount</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function reads data from the IIC serial EEPROM into a specified buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">BufferPtr</td><td>contains the address of the data buffer to be filled. </td></tr>
    <tr><td class="paramname">ByteCount</td><td>contains the number of bytes in the buffer to be read.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>XST_SUCCESS if successful else XST_FAILURE.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>None. </dd></dl>

<p>References <a class="el" href="xiicps__repeated__start__example_8c.html#a40d92867ead2dc8efe06207b8b0f3494">EepromWriteData()</a>, <a class="el" href="group__iicps.html#ga5b67ad96b8c40bdd47c2c2f8a57f170c">XIicPs_BusIsBusy()</a>, <a class="el" href="group__iicps.html#ga87cbf2622a9c6ad66b18d4c3f9575a76">XIicPs_ClearOptions()</a>, <a class="el" href="group__iicps.html#ga21bdb2f8a1f09e027aa8b0e9d6648d75">XIicPs_MasterRecvPolled()</a>, <a class="el" href="group__iicps.html#ga820f2cd7e2c7b77b9b5966e87eae2c09">XIICPS_REP_START_OPTION</a>, and <a class="el" href="group__iicps.html#gaec1dc5be2be8a7394263cfe56af976c5">XIicPs_SetOptions()</a>.</p>

<p>Referenced by <a class="el" href="xiicps__repeated__start__example_8c.html#a03067e867debb67e8cc850dad9b4491b">IicPsRepeatedStartExample()</a>.</p>

</div>
</div>
<a class="anchor" id="a40d92867ead2dc8efe06207b8b0f3494"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int EepromWriteData </td>
          <td>(</td>
          <td class="paramtype">u16&#160;</td>
          <td class="paramname"><em>ByteCount</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function writes a buffer of data to the IIC serial EEPROM. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ByteCount</td><td>contains the number of bytes in the buffer to be written.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>XST_SUCCESS if successful else XST_FAILURE.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The Byte count should not exceed the page size of the EEPROM as noted by the constant PAGE_SIZE. </dd></dl>

<p>References <a class="el" href="struct_x_iic_ps.html#adfabb9b5df439e3d18dde86763548e95">XIicPs::IsRepeatedStart</a>, <a class="el" href="group__iicps.html#ga5b67ad96b8c40bdd47c2c2f8a57f170c">XIicPs_BusIsBusy()</a>, and <a class="el" href="group__iicps.html#ga71584f1a7e675cde41cfd9d1bd4320b4">XIicPs_MasterSendPolled()</a>.</p>

<p>Referenced by <a class="el" href="xiicps__repeated__start__example_8c.html#a2f790bd9169574f1a1a9739b827cd04f">EepromReadDataRepStart()</a>, <a class="el" href="xiicps__eeprom__intr__example_8c.html#abd1f1d9ea1182f160893ef537bfc6010">IicPsEepromIntrExample()</a>, <a class="el" href="xiicps__eeprom__polled__example_8c.html#a344b0fbb418b58fc6832b1200295a07e">IicPsEepromPolledExample()</a>, and <a class="el" href="xiicps__repeated__start__example_8c.html#a03067e867debb67e8cc850dad9b4491b">IicPsRepeatedStartExample()</a>.</p>

</div>
</div>
<a class="anchor" id="a03067e867debb67e8cc850dad9b4491b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int IicPsRepeatedStartExample </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function writes, reads, and verifies the data to the IIC EEPROM. </p>
<p>Page write is used. Buffered read with repeated start option is done.</p>
<dl class="section return"><dt>Returns</dt><dd>XST_SUCCESS if successful else XST_FAILURE.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>None. </dd></dl>

<p>References <a class="el" href="struct_x_iic_ps___config.html#a2bdee49f560d4a22a433c6c327d6d912">XIicPs_Config::BaseAddress</a>, <a class="el" href="xiicps__repeated__start__example_8c.html#a2f790bd9169574f1a1a9739b827cd04f">EepromReadDataRepStart()</a>, <a class="el" href="xiicps__repeated__start__example_8c.html#a40d92867ead2dc8efe06207b8b0f3494">EepromWriteData()</a>, <a class="el" href="group__iicps.html#gae97ad9c202953c7e49bfb56533c47079">XIicPs_CfgInitialize()</a>, <a class="el" href="group__iicps.html#ga14c7ff4f51185d8aab0028c0eeb3c336">XIicPs_LookupConfig()</a>, and <a class="el" href="group__iicps.html#gafb24cfdacf6cf28d80126862dc1cfbe5">XIicPs_SetSClk()</a>.</p>

<p>Referenced by <a class="el" href="xiicps__repeated__start__example_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a840291bc02cba5474a4cb46a9b9566fe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main function to call the Iic repeated start example. </p>
<dl class="section return"><dt>Returns</dt><dd>XST_SUCCESS if successful else XST_FAILURE.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>None. </dd></dl>

<p>References <a class="el" href="xiicps__repeated__start__example_8c.html#a03067e867debb67e8cc850dad9b4491b">IicPsRepeatedStartExample()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
	<p class="footer">&copy; Copyright 2015-2022 Xilinx, Inc. All Rights Reserved.</p>
	<p class="footer">&copy; Copyright 2022-2023 Advanced Micro Devices, Inc. All Rights Reserved.</p>
</div>
</body>
</html>
